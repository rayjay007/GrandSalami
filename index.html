<script>
  async function loadRuns() {
    try {
      const res = await fetch("https://site.api.espn.com/apis/site/v2/sports/baseball/mlb/scoreboard");
      const data = await res.json();

      let home = 0, away = 0;
      let scoredGames = 0;

      data.events.forEach(event => {
        const teams = event.competitions[0].competitors;

        const homeTeam = teams.find(t => t.homeAway === "home");
        const awayTeam = teams.find(t => t.homeAway === "away");

        const homeScore = parseInt(homeTeam.score);
        const awayScore = parseInt(awayTeam.score);

        if (!isNaN(homeScore) && !isNaN(awayScore)) {
          home += homeScore;
          away += awayScore;
          scoredGames++;
        }
      });

      const total = home + away;

      if (scoredGames === 0) {
        document.getElementById("home").textContent = "Waiting...";
        document.getElementById("away").textContent = "Waiting...";
        document.getElementById("total").textContent = "Waiting for first pitch...";
      } else {
        document.getElementById("home").textContent = home;
        document.getElementById("away").textContent = away;
        document.getElementById("total").textContent = total;
      }

      const timeNow = new Date().toLocaleTimeString();
      document.getElementById("lastUpdated").textContent = `Last updated: ${timeNow}`;
    } catch (err) {
      document.getElementById("lastUpdated").textContent = "⚠️ Error fetching data";
      document.getElementById("home").textContent = "—";
      document.getElementById("away").textContent = "—";
      document.getElementById("total").textContent = "Check connection";
    }
  }
</script>
